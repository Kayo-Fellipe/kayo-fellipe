// Portfolio Data - Define all projects and their galleries
const portfolioData = {
  portraits: {
    title: "Sessão de Retratos",
    type: "photography",
    items: [
      {
        type: "image",
        src: "https://images.pexels.com/photos/2403005/pexels-photo-2403005.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/2403005/pexels-photo-2403005.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1385472/pexels-photo-1385472.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1385472/pexels-photo-1385472.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  wedding: {
    title: "Fotografia de Casamento",
    type: "photography",
    items: [
      {
        type: "image",
        src: "https://images.pexels.com/photos/1619317/pexels-photo-1619317.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1619317/pexels-photo-1619317.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1024993/pexels-photo-1024993.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1024993/pexels-photo-1024993.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1455872/pexels-photo-1455872.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1455872/pexels-photo-1455872.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1444442/pexels-photo-1444442.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1444442/pexels-photo-1444442.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1444424/pexels-photo-1444424.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1444424/pexels-photo-1444424.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  products: {
    title: "Fotografia de Produtos",
    type: "photography",
    items: [
      {
        type: "image",
        src: "https://images.pexels.com/photos/4350115/pexels-photo-4350115.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/4350115/pexels-photo-4350115.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/335257/pexels-photo-335257.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/335257/pexels-photo-335257.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1054775/pexels-photo-1054775.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1054775/pexels-photo-1054775.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  street: {
    title: "Street Photography",
    type: "photography",
    items: [
      {
        type: "image",
        src: "https://images.pexels.com/photos/1687845/pexels-photo-1687845.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1687845/pexels-photo-1687845.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1170986/pexels-photo-1170986.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1170986/pexels-photo-1170986.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1701595/pexels-photo-1701595.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1701595/pexels-photo-1701595.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1043459/pexels-photo-1043459.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1043459/pexels-photo-1043459.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  "wedding-video": {
    title: "Destaque do Casamento",
    type: "videography",
    items: [
      {
        type: "video",
        src: "https://player.vimeo.com/video/341373322?autoplay=1",
        thumbnail: "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  commercial: {
    title: "Anúncio Comercial",
    type: "videography",
    items: [
      {
        type: "video",
        src: "https://player.vimeo.com/video/557293933?autoplay=1",
        thumbnail: "https://images.pexels.com/photos/3379934/pexels-photo-3379934.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/3379934/pexels-photo-3379934.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/3379934/pexels-photo-3379934.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  "music-video": {
    title: "Vídeoclipe",
    type: "videography",
    items: [
      {
        type: "video",
        src: "https://player.vimeo.com/video/461045527?autoplay=1",
        thumbnail: "https://images.pexels.com/photos/1409999/pexels-photo-1409999.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/1409999/pexels-photo-1409999.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/1409999/pexels-photo-1409999.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  },
  
  corporate: {
    title: "Vídeo Corporativo",
    type: "videography",
    items: [
      {
        type: "video",
        src: "https://www.youtube.com/watch?v=RXlM8sI18LI", 
        thumbnail: "https://images.pexels.com/photos/3944091/pexels-photo-3944091.jpeg?auto=compress&cs=tinysrgb&w=200"
      },
      {
        type: "image",
        src: "https://images.pexels.com/photos/3944091/pexels-photo-3944091.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        thumbnail: "https://images.pexels.com/photos/3944091/pexels-photo-3944091.jpeg?auto=compress&cs=tinysrgb&w=200"
      }
    ]
  }
};

// Portfolio Class
class Portfolio {
  constructor() {
    this.currentProject = null;
    this.currentIndex = 0;
    this.init();
  }

  init() {
    this.bindEvents();
    this.setupFiltering();
  }

  bindEvents() {
    // Portfolio links
    const portfolioLinks = document.querySelectorAll('.portfolio-link');
    portfolioLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const projectId = link.getAttribute('data-project');
        this.openGallery(projectId);
      });
    });

    // Modal controls
    const modal = document.getElementById('gallery-modal');
    const closeBtn = document.getElementById('close-modal');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    closeBtn.addEventListener('click', () => this.closeGallery());
    prevBtn.addEventListener('click', () => this.previousItem());
    nextBtn.addEventListener('click', () => this.nextItem());

    // Close modal when clicking outside
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        this.closeGallery();
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (modal.classList.contains('active')) {
        switch(e.key) {
          case 'Escape':
            this.closeGallery();
            break;
          case 'ArrowLeft':
            this.previousItem();
            break;
          case 'ArrowRight':
            this.nextItem();
            break;
        }
      }
    });
  }

  setupFiltering() {
    const filterBtns = document.querySelectorAll('.filter-btn');
    const portfolioItems = document.querySelectorAll('.portfolio-item');

    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Update active button
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Filter items
        const filter = btn.getAttribute('data-filter');
        
        portfolioItems.forEach(item => {
          if (filter === 'all' || item.classList.contains(filter)) {
            item.style.display = 'block';
            setTimeout(() => {
              item.style.opacity = '1';
              item.style.transform = 'translateY(0)';
            }, 10);
          } else {
            item.style.opacity = '0';
            item.style.transform = 'translateY(20px)';
            setTimeout(() => {
              item.style.display = 'none';
            }, 300);
          }
        });
      });
    });
  }

  openGallery(projectId) {
    const project = portfolioData[projectId];
    if (!project) return;

    this.currentProject = project;
    this.currentIndex = 0;

    // Update modal content
    document.getElementById('gallery-title').textContent = project.title;
    document.getElementById('total-items').textContent = project.items.length;

    // Generate thumbnails
    this.generateThumbnails();

    // Show first item
    this.showCurrentItem();

    // Show modal
    const modal = document.getElementById('gallery-modal');
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';

    // Update navigation buttons
    this.updateNavigation();
  }

  closeGallery() {
    const modal = document.getElementById('gallery-modal');
    modal.classList.remove('active');
    document.body.style.overflow = 'auto';

    // Clear iframe sources to stop videos
    const iframes = modal.querySelectorAll('iframe');
    iframes.forEach(iframe => {
      iframe.src = '';
    });

    this.currentProject = null;
    this.currentIndex = 0;
  }

  showCurrentItem() {
    if (!this.currentProject) return;

    const item = this.currentProject.items[this.currentIndex];
    const galleryMain = document.getElementById('gallery-main');
    
    // Update counter
    document.getElementById('current-index').textContent = this.currentIndex + 1;

    // Clear current content
    galleryMain.innerHTML = '';

    // Add new content
    if (item.type === 'image') {
      const img = document.createElement('img');
      img.src = item.src;
      img.alt = this.currentProject.title;
      img.addEventListener('load', () => {
        img.style.opacity = '1';
      });
      img.style.opacity = '0';
      img.style.transition = 'opacity 0.3s ease';
      galleryMain.appendChild(img);
    } else if (item.type === 'video') {
      const iframe = document.createElement('iframe');
      iframe.src = item.src;
      iframe.allow = 'autoplay; fullscreen; picture-in-picture';
      iframe.allowFullscreen = true;
      galleryMain.appendChild(iframe);
    }

    // Update thumbnail active state
    this.updateThumbnailActive();
    this.updateNavigation();
  }

  generateThumbnails() {
    const thumbnailsContainer = document.getElementById('gallery-thumbnails');
    thumbnailsContainer.innerHTML = '';

    this.currentProject.items.forEach((item, index) => {
      const thumbnail = document.createElement('div');
      thumbnail.className = `thumbnail ${item.type}`;
      if (index === 0) thumbnail.classList.add('active');

      const img = document.createElement('img');
      img.src = item.thumbnail;
      img.alt = `${this.currentProject.title} ${index + 1}`;
      
      thumbnail.appendChild(img);
      thumbnail.addEventListener('click', () => {
        this.currentIndex = index;
        this.showCurrentItem();
      });

      thumbnailsContainer.appendChild(thumbnail);
    });
  }

  updateThumbnailActive() {
    const thumbnails = document.querySelectorAll('.thumbnail');
    thumbnails.forEach((thumb, index) => {
      thumb.classList.toggle('active', index === this.currentIndex);
    });
  }

  previousItem() {
    if (!this.currentProject || this.currentIndex <= 0) return;
    this.currentIndex--;
    this.showCurrentItem();
  }

  nextItem() {
    if (!this.currentProject || this.currentIndex >= this.currentProject.items.length - 1) return;
    this.currentIndex++;
    this.showCurrentItem();
  }

  updateNavigation() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    if (!this.currentProject) return;

    prevBtn.disabled = this.currentIndex <= 0;
    nextBtn.disabled = this.currentIndex >= this.currentProject.items.length - 1;
  }
}

// Initialize Portfolio when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  new Portfolio();
});